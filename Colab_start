# -------------------------------
# Gabon Tree Exploration Project
# Colab Template
# -------------------------------

# 1Ô∏è‚É£ Mount Google Drive (for large data files)
from google.colab import drive
drive.mount('/content/drive')

# Update paths to your Drive folders
DRIVE_PATH = "/content/drive/MyDrive/GabonTreeProject"
DATA_PATH = f"{DRIVE_PATH}/data"
OUTPUTS_PATH = f"{DRIVE_PATH}/outputs"

# 2Ô∏è‚É£ Clone GitHub repo
# Replace with your actual repo URL
!git clone https://github.com/username/repo_name.git
%cd repo_name

# 3Ô∏è‚É£ Install dependencies
!pip install -r requirements.txt

# Optional: install your local decid package
!pip install -e scripts/

# 4Ô∏è‚É£ Add scripts folder to Python path
import sys
sys.path.append("scripts")

# 5Ô∏è‚É£ Run notebooks sequentially
# You can comment/uncomment the ones you want
notebooks = [
    "scripts/1_data_cleanup.ipynb",
    "scripts/2_diameter_comparison.ipynb",
    "scripts/3_diurnal_changes.ipynb",
    "scripts/4_climate.ipynb",
    "scripts/5_water_relations.ipynb",
    "scripts/6_phenocam_data_animation.ipynb",  # optional animation
    "scripts/6_rain_and_flowering.ipynb"
]

for nb in notebooks:
    print(f"üöÄ Executing {nb} ...")
    !jupyter nbconvert --to notebook --execute "{nb}" --output executed_{nb.split('/')[-1]}

# 6Ô∏è‚É£ Optional: run phenocam animation separately
from decid_package import image_animation as phenocam

zip_path = f"{DATA_PATH}/Phenocams.zip"
start_time = "2024-10-22 12:00:00"
end_time = "2024-10-30 12:30:00"
interval = 100  # milliseconds per frame
export_path = f"{OUTPUTS_PATH}/phenocam_videos/phenocam_leaf_flush.mp4"

phenocam.run_phenocam_animation(zip_path, start_time, end_time, interval, export_path)
